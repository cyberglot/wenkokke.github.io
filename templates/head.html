<head>
    <meta charset="utf-8"/>
    <link href="http://gmpg.org/xfn/11" rel="profile"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"/>

    <title>
        $if(title)$
        $title$
        $else$
        $site.title$
        $endif$
    </title>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/style.css"/>
    $if(css-include)$
    $for(css-include)$
    <link rel="stylesheet" href="$css-include$"/>
    $endfor$
    $endif$

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"/>

    <!-- Fix citations -->
    <script>
     document.addEventListener("DOMContentLoaded", function () {
         const citations = document.querySelectorAll('.citation');
         for (let citationSpan of citations) {
             const firstRefId = citationSpan.getAttribute('DATA-CITES').split(' ');
             const citationLink = document.createElement('A');
             citationLink.innerHTML = citationSpan.innerHTML;
             citationLink.setAttribute('href', '#'+firstRefId);
             citationSpan.replaceWith(citationLink);
         }
     });
    </script>

    <!-- Setup KaTeX -->
    <script defer src="/assets/js/katex.min.js"></script>
    <script>
     document.addEventListener("DOMContentLoaded", function () {
         const mathElements = document.getElementsByClassName("math");
         const macros = [];
         for (var i = 0; i < mathElements.length; i++) {
             const texText = mathElements[i].firstChild;
             if (mathElements[i].tagName == "SPAN") {
                 katex.render(texText.data, mathElements[i], {
                     displayMode: mathElements[i].classList.contains('display'),
                     throwOnError: false,
                     macros: macros,
                     fleqn: true
                 });
             }
         }
     });
    </script>
</head>
